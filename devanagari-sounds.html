<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Devanagari Letter Sounds</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;600&display=swap" rel="stylesheet">

<style>
body { font-family: system-ui, Arial, sans-serif; padding: 16px; }
h1 { font-size: 20px; margin-bottom: 8px; }

.grid, .grid5, .line, button {
  font-family: "Noto Sans Devanagari","Nirmala UI","Mangal",system-ui,sans-serif;
}

.grid { display:grid; grid-template-columns:repeat(8,1fr); gap:10px; max-width:900px; }
.grid5 { display:grid; grid-template-columns:repeat(5,1fr); gap:10px; max-width:520px; }
.line { display:flex; gap:10px; flex-wrap:wrap; max-width:900px; }

button {
  font-size:26px;
  padding:10px 0;
  border-radius:12px;
  border:1px solid #ddd;
  background:white;
  cursor:pointer;
}
button.correct { background:#d4f8d4; border-color:#2f9e44; }
button.wrong { background:#ffd6d6; border-color:#c92a2a; }

.row { display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-bottom:10px; }
label { font-size:14px; }
select { padding:6px; border-radius:8px; }

.pill { font-size:13px; padding:6px 10px; border-radius:999px; border:1px solid #ddd; background:#fafafa; }
.small { font-size:13px; color:#666; margin-top:10px; }
</style>
</head>

<body>
<h1>Sanskrit Pronunciation Tool</h1>

<div class="row">
  <span class="pill" id="status">Ready</span>

  <label><input type="checkbox" id="showHint" checked> Show hint</label>

  <label>
    Display:
    <select id="scheme">
      <option value="deva">Devanagari</option>
      <option value="iast">IAST</option>
      <option value="hk">Harvard–Kyoto</option>
    </select>
  </label>

  <label><input type="checkbox" id="quizMode"> Quiz</label>

  <label><input type="radio" name="quizType" value="listen" checked> Listen → Click</label>
  <label><input type="radio" name="quizType" value="reverse"> See → Guess</label>

  <button id="newQ">Play / Next</button>
  <span class="pill" id="qPrompt">Quiz off</span>
</div>

<h2>स्वराः</h2>
<div class="grid" id="grid-vowels"></div>

<h2>वर्गीय व्यञ्जनानि</h2>
<div class="grid5" id="grid-vargiya"></div>

<h2>अवर्गीय व्यञ्जनानि</h2>
<div class="line" id="line-avargiya"></div>

<p class="small">Hosted audio required (GitHub Pages works).</p>

<script>
const AUDIO_BASE_URL = "https://laksiyer.github.io/ucchAraNam/audio/";

/* ===== DATA ===== */
const vowels = [
 {key:"a",deva:"अ",iast:"a",hk:"a",hint:"a",file:"a.mp3"},
 {key:"aa",deva:"आ",iast:"ā",hk:"A",hint:"ā",file:"aa.mp3"},
 {key:"i",deva:"इ",iast:"i",hk:"i",hint:"i",file:"i.mp3"},
 {key:"ii",deva:"ई",iast:"ī",hk:"I",hint:"ī",file:"ii.mp3"},
 {key:"u",deva:"उ",iast:"u",hk:"u",hint:"u",file:"u.mp3"},
 {key:"uu",deva:"ऊ",iast:"ū",hk:"U",hint:"ū",file:"uu.mp3"},
 {key:"ri",deva:"ऋ",iast:"ṛ",hk:"R",hint:"ṛ",file:"ri.mp3"},
 {key:"e",deva:"ए",iast:"e",hk:"e",hint:"e",file:"e.mp3"},
 {key:"ai",deva:"ऐ",iast:"ai",hk:"ai",hint:"ai",file:"ai.mp3"},
 {key:"o",deva:"ओ",iast:"o",hk:"o",hint:"o",file:"o.mp3"},
 {key:"au",deva:"औ",iast:"au",hk:"au",hint:"au",file:"au.mp3"}
];

const vargiya = [
 {key:"ka",deva:"क",iast:"ka",hk:"ka",hint:"ka",file:"ka.mp3"},
 {key:"kha",deva:"ख",iast:"kha",hk:"kha",hint:"kha",file:"kha.mp3"},
 {key:"ga",deva:"ग",iast:"ga",hk:"ga",hint:"ga",file:"ga.mp3"},
 {key:"gha",deva:"घ",iast:"gha",hk:"gha",hint:"gha",file:"gha.mp3"},
 {key:"nga",deva:"ङ",iast:"ṅa",hk:"Ga",hint:"ṅa",file:"nga.mp3"},
 {key:"ca",deva:"च",iast:"ca",hk:"ca",hint:"ca",file:"ca.mp3"},
 {key:"cha",deva:"छ",iast:"cha",hk:"cha",hint:"cha",file:"cha.mp3"},
 {key:"ja",deva:"ज",iast:"ja",hk:"ja",hint:"ja",file:"ja.mp3"},
 {key:"jha",deva:"झ",iast:"jha",hk:"jha",hint:"jha",file:"jha.mp3"},
 {key:"nya",deva:"ञ",iast:"ña",hk:"Ja",hint:"ña",file:"nya.mp3"}
];

const avargiya = [
 {key:"ya",deva:"य",iast:"ya",hk:"ya",hint:"ya",file:"ya.mp3"},
 {key:"ra",deva:"र",iast:"ra",hk:"ra",hint:"ra",file:"ra.mp3"},
 {key:"la",deva:"ल",iast:"la",hk:"la",hint:"la",file:"la.mp3"},
 {key:"va",deva:"व",iast:"va",hk:"va",hint:"va",file:"va.mp3"},
 {key:"sa",deva:"स",iast:"sa",hk:"sa",hint:"sa",file:"sa.mp3"},
 {key:"ha",deva:"ह",iast:"ha",hk:"ha",hint:"ha",file:"ha.mp3"}
];

const all = [...vowels,...vargiya,...avargiya];
const byKey = new Map(all.map(x=>[x.key,x]));

/* ===== STATE ===== */
let scheme="deva";
let quizType="listen";
let quizAnswer=null;
const quizPool=[...vargiya,...avargiya];

const player=new Audio();
const status=document.getElementById("status");
const qPrompt=document.getElementById("qPrompt");

/* ===== HELPERS ===== */
function labelOf(x){return x[scheme]||x.deva;}
function clearColors(){document.querySelectorAll("button").forEach(b=>b.classList.remove("correct","wrong"));}

function playFile(file,msg){
 player.pause(); player.currentTime=0;
 player.src=AUDIO_BASE_URL+file;
 status.textContent=msg;
 player.play();
}

function startQuestion(){
 clearColors();
 const x=quizPool[Math.floor(Math.random()*quizPool.length)];
 quizAnswer=x.key;
 if(quizType==="listen"){
   qPrompt.textContent="Listen → Click";
   playFile(x.file,"Quiz");
 } else {
   qPrompt.textContent="See → Guess → Play";
   status.textContent="Shown: "+labelOf(x);
 }
}

/* ===== RENDER ===== */
function render(containerId,items){
 const c=document.getElementById(containerId);
 items.forEach(x=>{
   const b=document.createElement("button");
   b.textContent=labelOf(x);
   b.onclick=()=>{
     if(!document.getElementById("quizMode").checked){
       playFile(x.file,labelOf(x));
       return;
     }
     clearColors();
     if(x.key===quizAnswer){
       b.classList.add("correct");
       qPrompt.textContent="✅ Correct";
       playFile(x.file,"Correct");
       setTimeout(startQuestion,700);
     } else {
       b.classList.add("wrong");
       qPrompt.textContent="❌ Try again";
     }
   };
   b.dataset.key=x.key;
   c.appendChild(b);
 });
}

render("grid-vowels",vowels);
render("grid-vargiya",vargiya);
render("line-avargiya",avargiya);

/* ===== CONTROLS ===== */
document.getElementById("scheme").onchange=e=>{
 scheme=e.target.value;
 document.querySelectorAll("button[data-key]").forEach(b=>{
   b.textContent=labelOf(byKey.get(b.dataset.key));
 });
};

document.getElementsByName("quizType").forEach(r=>{
 r.onchange=e=>quizType=e.target.value;
});

document.getElementById("newQ").onclick=()=>{
 if(!document.getElementById("quizMode").checked) return;
 if(quizType==="reverse" && quizAnswer){
   playFile(byKey.get(quizAnswer).file,"Reveal");
 } else startQuestion();
};

document.getElementById("quizMode").onchange=e=>{
 if(e.target.checked) startQuestion();
 else qPrompt.textContent="Quiz off";
};
</script>
</body>
</html>
